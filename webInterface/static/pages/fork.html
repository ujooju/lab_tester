<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Таблица из JSON</title>
    <style>
        table {
            border-collapse: collapse;
            width: 60%;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid #999;
            padding: 8px 12px;
            text-align: left;
        }
        th {
            background: #eee;
        }
    </style>
</head>
<body>

<h2 id="repo_full_name"></h2>
<h2 id="to be done"></h2>
<h2><a href="/home">HomePage</a></h2>
<h2><a href="/logout">logout</a></h2>
<h2>Ветки</h2>
<table id="data-table"></table>
<h2>Тесты</h2>
<table id="tests-table"></table>

<script>
// Пример API — можно подставить свой URL
const API_URL_BRANCHES = "/api/fork-branches";
const API_URL_STATUS = "/api/fork-status";
const API_URL_TESTS = "/api/list-tests";

const urlParams = new URLSearchParams(window.location.search);
forkName = urlParams.get('name');
forkOwner = urlParams.get('owner');

async function loadName() {
    document.getElementById("repo_full_name").textContent = 
        "Решение: " + forkOwner + "/" + forkName;
}

async function loadTable(tableId, apiURL) {
    const response = await fetch(apiURL + "?owner=" + forkOwner + "&name=" + forkName);
    const data = await response.json();

    const table = document.getElementById(tableId);
    // Получаем названия ключей для заголовков таблицы
    const headers = Object.keys(data[0]);

    // Строим строки с данными
    data.forEach(item => {
        const row = document.createElement("tr");
        headers.forEach(key => {
            const td = document.createElement("td");
            if (key === "submit_url") {
                const a = document.createElement("a")
                a.href = item[key]
                a.textContent = "submit"
                td.appendChild(a)
            } else {
            td.textContent = 
                typeof item[key] === "object" ? JSON.stringify(item[key]) : item[key];
            }
            row.appendChild(td);
        });
        table.appendChild(row);
    });
}

loadTable("data-table", API_URL_BRANCHES);
loadTable("tests-table", API_URL_TESTS);
loadName();

</script>

</body>
</html>